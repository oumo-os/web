<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>oumo.studio</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #0a0a0a;
            color: #e5e5e5;
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Animated background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: 
                radial-gradient(circle at 20% 20%, rgba(15, 23, 42, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(30, 41, 59, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 40% 60%, rgba(51, 65, 85, 0.1) 0%, transparent 50%);
            z-index: -1;
            animation: drift 20s ease-in-out infinite alternate;
        }

        @keyframes drift {
            0% { transform: translate(0, 0) rotate(0deg); }
            100% { transform: translate(-10px, -20px) rotate(1deg); }
        }

        .container {
            display: flex;
            min-height: 100vh;
        }

        /* Left Navigation Panel */
        .nav-panel {
            position: fixed;
            left: 0;
            top: 0;
            width: 320px;
            height: 100vh;
            background: rgba(12, 12, 12, 0.95);
            backdrop-filter: blur(20px);
            border-right: 1px solid rgba(255, 255, 255, 0.08);
            display: flex;
            flex-direction: column;
            z-index: 100;
        }

        /* Header in nav panel */
        .header {
            padding: 2rem 1.5rem 1.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.08);
        }

        .logo {
            font-size: 1.75rem;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 0.75rem;
            letter-spacing: -0.02em;
        }

        .tagline {
            font-size: 0.85rem;
            color: #888;
            line-height: 1.4;
            font-weight: 400;
        }

        /* Navigation */
        .nav-section {
            flex: 1;
            padding: 1.5rem;
            overflow-y: auto;
        }

        .nav-title {
            font-size: 0.7rem;
            font-weight: 600;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 1rem;
        }

        .nav-list {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
            margin-bottom: 2rem;
        }

        .nav-item {
            padding: 0.75rem 1rem;
            border-radius: 8px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid transparent;
            color: #ccc;
            text-decoration: none;
            display: block;
        }

        .nav-item:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(255, 255, 255, 0.1);
            color: #fff;
        }

        .nav-item.active {
            background: rgba(59, 130, 246, 0.15);
            border-color: rgba(59, 130, 246, 0.3);
            color: #60a5fa;
        }

        /* Status indicator */
        .status-section {
            padding: 1.5rem;
            border-top: 1px solid rgba(255, 255, 255, 0.08);
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.8rem;
            color: #666;
            margin-bottom: 0.5rem;
        }

        .status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #10b981;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Footer */
        .footer {
            padding: 1.5rem;
            border-top: 1px solid rgba(255, 255, 255, 0.08);
            font-size: 0.75rem;
            color: #555;
            font-family: 'SF Mono', 'Monaco', 'Cascadia Code', monospace;
        }

        /* Main content area */
        .main-content {
            margin-left: 320px;
            flex: 1;
            padding: 2rem;
            min-height: 100vh;
        }

        /* Content sections */
        .content-section {
            display: none;
            animation: fadeIn 0.3s ease-in-out;
        }

        .content-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-header {
            margin-bottom: 2rem;
        }

        .section-title {
            font-size: 2.25rem;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 0.5rem;
            letter-spacing: -0.02em;
        }

        .section-subtitle {
            font-size: 1rem;
            color: #888;
            font-weight: 400;
        }

        /* Cards grid */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 1.5rem;
            margin-bottom: 3rem;
        }

        .content-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 1.75rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .content-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.5), transparent);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .content-card:hover {
            transform: translateY(-2px);
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(255, 255, 255, 0.15);
        }

        .content-card:hover::before {
            opacity: 1;
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
        }

        .card-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: #ffffff;
            margin: 0;
        }

        .card-status {
            font-size: 0.75rem;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-weight: 500;
        }

        .status-prototype {
            background: rgba(245, 158, 11, 0.15);
            color: #f59e0b;
            border: 1px solid rgba(245, 158, 11, 0.3);
        }

        .status-active {
            background: rgba(16, 185, 129, 0.15);
            color: #10b981;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .status-concept {
            background: rgba(139, 92, 246, 0.15);
            color: #8b5cf6;
            border: 1px solid rgba(139, 92, 246, 0.3);
        }

        .card-description {
            font-size: 0.9rem;
            color: #bbb;
            line-height: 1.5;
        }

        /* Writings section */
        .writings-list {
            list-style: none;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .writing-item {
            padding: 1.25rem;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 8px;
            transition: all 0.2s ease;
        }

        .writing-item:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(255, 255, 255, 0.15);
        }

        .writing-item a {
            color: #60a5fa;
            text-decoration: none;
            font-weight: 500;
            font-size: 1rem;
        }

        .writing-item a:hover {
            color: #93c5fd;
        }

        /* About section */
        .about-content {
            max-width: 700px;
        }

        .about-text {
            font-size: 1.05rem;
            color: #ccc;
            line-height: 1.7;
            margin-bottom: 2rem;
        }

        /* Links section */
        .links-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-top: 2rem;
        }

        .link-item {
            padding: 1rem;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 8px;
            text-align: center;
            transition: all 0.2s ease;
            color: #888;
            text-decoration: none;
            font-size: 0.85rem;
            font-family: 'SF Mono', 'Monaco', 'Cascadia Code', monospace;
        }

        .link-item:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(255, 255, 255, 0.15);
            color: #60a5fa;
        }

        /* Contact section specific styles */
        .contact-info {
            font-size: 1rem;
            color: #ccc;
            margin-bottom: 1.5rem;
        }

        .contact-info p {
            margin-bottom: 0.75rem;
        }

        .contact-info a {
            color: #60a5fa;
            text-decoration: none;
            transition: color 0.2s ease;
        }

        .contact-info a:hover {
            color: #93c5fd;
        }

        .social-links-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 1rem;
            margin-top: 2rem;
        }

        .social-link-item {
            padding: 1rem;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 8px;
            text-align: center;
            transition: all 0.2s ease;
            color: #888;
            text-decoration: none;
            font-size: 0.85rem;
            font-family: 'SF Mono', 'Monaco', 'Cascadia Code', monospace;
        }

        .social-link-item:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(255, 255, 255, 0.15);
            color: #60a5fa;
        }

        /* Content Page Layout */
        .content-page {
            display: flex;
            gap: 2rem;
            max-width: 1400px;
        }

        .content-sidebar {
            width: 280px;
            flex-shrink: 0;
            position: sticky;
            top: 2rem;
            height: fit-content;
        }

        .content-meta {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .content-meta h3 {
            font-size: 1rem;
            font-weight: 600;
            color: #fff;
            margin-bottom: 1rem;
        }

        .meta-item {
            margin-bottom: 1.5rem;
        }

        .meta-label {
            font-size: 0.7rem;
            font-weight: 600;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 0.5rem;
        }

        .meta-value {
            font-size: 0.85rem;
            color: #ccc;
            line-height: 1.4;
        }

        .tag-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .tag {
            padding: 0.25rem 0.75rem;
            background: rgba(59, 130, 246, 0.15);
            color: #60a5fa;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 500;
            border: 1px solid rgba(59, 130, 246, 0.3);
        }

        .external-links {
            list-style: none;
        }

        .external-links li {
            margin-bottom: 0.5rem;
        }

        .external-links a {
            color: #60a5fa;
            text-decoration: none;
            font-size: 0.85rem;
            transition: color 0.2s ease;
        }

        .external-links a:hover {
            color: #93c5fd;
        }

        .back-button {
            width: 100%;
            padding: 0.75rem;
            background: rgba(255, 255, 255, 0.05);
            color: #ccc;
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .back-button:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(255, 255, 255, 0.15);
            color: #fff;
        }

        .content-article {
            flex: 1;
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 2.5rem;
            min-height: 80vh;
        }

        .article-header {
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.08);
        }

        .article-title {
            font-size: 2.5rem;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 1rem;
            letter-spacing: -0.02em;
            line-height: 1.2;
        }

        .article-subtitle {
            font-size: 1.125rem;
            color: #888;
            font-weight: 400;
            line-height: 1.5;
        }

        .article-content {
            font-size: 1rem;
            line-height: 1.7;
            color: #ccc;
        }

        .article-content h2 {
            font-size: 1.5rem;
            font-weight: 600;
            color: #fff;
            margin: 2rem 0 1rem;
            letter-spacing: -0.01em;
        }

        .article-content h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: #e5e5e5;
            margin: 1.5rem 0 0.75rem;
        }

        .article-content p {
            margin-bottom: 1.25rem;
        }

        .article-content blockquote {
            border-left: 3px solid #60a5fa;
            padding-left: 1.5rem;
            margin: 1.5rem 0;
            font-style: italic;
            color: #aaa;
        }

        .article-content code {
            background: rgba(255, 255, 255, 0.05);
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-family: 'SF Mono', 'Monaco', 'Cascadia Code', monospace;
            font-size: 0.9rem;
            color: #60a5fa;
        }

        .article-content pre {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            overflow-x: auto;
            font-family: 'SF Mono', 'Monaco', 'Cascadia Code', monospace;
            font-size: 0.85rem;
            line-height: 1.5;
        }

        .article-content ul, .article-content ol {
            margin-left: 1.5rem;
            margin-bottom: 1.25rem;
        }

        .article-content li {
            margin-bottom: 0.5rem;
        }

        /* LLM Button Styles */
        .llm-button-group {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .llm-button {
            padding: 0.75rem 1.25rem;
            background: rgba(59, 130, 246, 0.2);
            color: #60a5fa;
            border: 1px solid rgba(59, 130, 246, 0.4);
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .llm-button:hover {
            background: rgba(59, 130, 246, 0.3);
            border-color: rgba(59, 130, 246, 0.6);
            color: #93c5fd;
        }

        .llm-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .llm-output {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1.5rem;
            font-size: 0.95rem;
            color: #e0e0e0;
            line-height: 1.6;
            white-space: pre-wrap; /* Preserve whitespace and line breaks */
        }

        .loading-spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid #60a5fa;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
            vertical-align: middle;
            margin-left: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive content page */
        @media (max-width: 768px) {
            .content-page {
                flex-direction: column;
                gap: 1.5rem;
            }

            .content-sidebar {
                width: 100%;
                position: static;
            }

            .content-article {
                padding: 1.5rem;
            }

            .article-title {
                font-size: 2rem;
            }
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .nav-panel {
                width: 280px;
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }

            .nav-panel.open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
                padding: 1rem;
            }

            .section-title {
                font-size: 1.75rem;
            }

            .cards-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            /* Mobile menu button */
.mobile-menu-btn {
  position: fixed;
  top: 1rem;
  right: 1rem;
  z-index: 200;
  background: rgba(12, 12, 12, 0.95);
  border: 1px solid rgba(255, 255, 255, 0.08);
  color: #fff;
  padding: 0.5rem;
  border-radius: 8px;
  cursor: pointer;
  display: block;
}
        }

        @media (min-width: 769px) {
            .mobile-menu-btn {
                display: none;
            }
        }
    </style>
</head>
<body>
    <button class="mobile-menu-btn" onclick="toggleNav()">☰</button>

    <div class="container">
        <!-- Left Navigation Panel -->
        <nav class="nav-panel" id="navPanel">
            <div class="header">
                <div class="logo">oumo.studio</div>
                <div class="tagline">A systems studio for futures, fragments, and frameworks</div>
            </div>

            <div class="nav-section">
                <div class="nav-title">Navigate</div>
                <div class="nav-list" id="main-nav-list">
                    <!-- Navigation items will be dynamically loaded here -->
                </div>

                <div class="nav-title">Quick Access</div>
                <div class="nav-list">
                    <a href="#" class="nav-item">Lab Access</a>
                </div>
            </div>

            <div class="status-section">
                <div class="status-item">
                    <div class="status-dot"></div>
                    <span>System Active</span>
                </div>
                <div class="status-item">
                    <div style="width: 6px; height: 6px; border-radius: 50%; background: #f59e0b;"></div>
                    <span>9 Prototypes/Concepts Running</span>
                </div>
            </div>

            <div class="footer">
                :: oumo.studio v0.2<br/>
                system.initialized();
            </div>
        </nav>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- About Section (Prime Page) -->
            <section id="about" class="content-section">
                <div class="section-header">
                    <h1 class="section-title">About</h1>
                    <p class="section-subtitle">Systems thinking at the intersection of imagination and engineering</p>
                </div>

                <div class="about-content">
                    <p class="about-text">
                        I'm Oumo — a systems thinker, conceptualist, and storyteller. I build thought frameworks and fiction-born realities to explore futures that might be worth arriving at.
                    </p>
                    
                    <p class="about-text">
                        <code>oumo.studio</code> is my lab. It's where engineering, imagination, and governance meet — sometimes in fiction, sometimes in code, always in pursuit of better coordination mechanisms for complex systems. Many of my real-world projects and concepts, such as Sagax/Mirai and the Orbis Framework, were initially inspired or directly birthed from the speculative narratives within the Tukei-verse.
                    </p>

                    <div class="links-grid">
                        <a href="#" class="link-item" onclick="showContent('sagax-mirai')">SAGAX/MIRAI</a>
                        <a href="#" class="link-item" onclick="showContent('orbx-platform')">ORBX PLATFORM</a>
                        <a href="#" class="link-item" onclick="showContent('dxn')">DXN</a>
                        <a href="https://github.com/your-github" target="_blank" class="link-item">GITHUB</a>
                        <a href="https://x.com/your-x-handle" target="_blank" class="link-item">X</a>
                        <a href="https://linkedin.com/in/your-linkedin" target="_blank" class="link-item">LINKEDIN</a>
                        <a href="#" class="link-item">LAB ACCESS</a>
                    </div>
                </div>
            </section>

            <!-- Dynamic Content Sections will be generated here -->
            <div id="dynamic-content-sections"></div>

            <!-- Contact Section -->
            <section id="contact" class="content-section">
                <div class="section-header">
                    <h1 class="section-title">Get in Touch</h1>
                    <p class="section-subtitle">Connect with Oumo.studio across various platforms and discuss collaborations.</p>
                </div>

                <div class="contact-content">
                    <div class="contact-info">
                        <p>For inquiries, collaborations, or just to say hello, feel free to reach out:</p>
                        <p>Email: <a href="mailto:contact@oumo.studio">contact@oumo.studio</a></p>
                    </div>

                    <h3>Find me on social media:</h3>
                    <div class="social-links-grid">
                        <a href="https://github.com/your-github" target="_blank" class="social-link-item">GitHub</a>
                        <a href="https://x.com/your-x-handle" target="_blank" class="social-link-item">X (Twitter)</a>
                        <a href="https://linkedin.com/in/your-linkedin" target="_blank" class="social-link-item">LinkedIn</a>
                        <!-- Add more social links as needed -->
                    </div>

                    <p style="margin-top: 2rem; color: #888; font-size: 0.9rem;">
                        I'm always open to discussing new ideas, potential partnerships, or just sharing thoughts on the future of systems and narratives.
                    </p>
                </div>
            </section>

            <!-- Content Page Template -->
            <section id="content-page" class="content-section">
                <div class="content-page">
                    <aside class="content-sidebar">
                        <div class="content-meta">
                            <h3 id="content-meta-title">Project Meta</h3>
                            
                            <div class="meta-item">
                                <div class="meta-label">Status</div>
                                <div class="meta-value" id="content-status">Prototype</div>
                            </div>

                            <div class="meta-item">
                                <div class="meta-label">Topics</div>
                                <div class="tag-list" id="content-tags">
                                    <span class="tag">Governance</span>
                                    <span class="tag">Systems</span>
                                    <span class="tag">Protocol</span>
                                </div>
                            </div>

                            <div class="meta-item">
                                <div class="meta-label">Timeline</div>
                                <div class="meta-value" id="content-timeline">2024 - Ongoing</div>
                            </div>

                            <div class="meta-item">
                                <div class="meta-label">Cross References</div>
                                <ul class="external-links" id="content-refs">
                                    <li><a href="#">Related Concept A</a></li>
                                    <li><a href="#">Related Concept B</a></li>
                                </ul>
                            </div>

                            <div class="meta-item">
                                <div class="meta-label">External Resources</div>
                                <ul class="external-links" id="content-external">
                                    <li><a href="#">Research Paper</a></li>
                                    <li><a href="#">Implementation Notes</a></li>
                                </ul>
                            </div>
                        </div>

                        <button class="back-button" onclick="goBack()">← Back to Overview</button>
                    </aside>

                    <article class="content-article">
                        <div class="article-header">
                            <h1 class="article-title" id="content-title">Orbx Protocol</h1>
                            <p class="article-subtitle" id="content-subtitle">A zero-trust protocol for decentralised governance and collective agency</p>
                        </div>

                        <div class="article-content" id="content-body">
                            <!-- Content will be loaded here by JavaScript -->
                        </div>
                    </article>
                </div>
            </section>
        </main>
    </div>

    <script>
        // Global variables to store fetched data
        let siteCategories = {};
        let siteContentItems = {};

        // Navigation functionality
        let navItems; // Will be populated after dynamic nav is built
        const contentSections = document.querySelectorAll('.content-section');
        let currentSection = 'about'; // Default to 'about'
        let previousSection = 'about';

        // Function to fetch all site data (categories and content items)
        async function fetchSiteData() {
            try {
                const response = await fetch('contents.json');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const data = await response.json();
                siteCategories = data.categories;
                siteContentItems = data.content_items;
                console.log('Site data loaded:', siteCategories, siteContentItems);

                // Build navigation and populate sections after data is loaded
                buildNavigation();
                populateSections();

                // Set the 'about' nav item as active and display it on load
                const aboutNavItem = document.querySelector('.nav-item[data-section="about"]');
                if (aboutNavItem) {
                    aboutNavItem.classList.add('active');
                    document.getElementById('about').classList.add('active');
                }
            } catch (error) {
                console.error('Error fetching site data:', error);
                document.querySelector('.main-content').innerHTML = `
                    <div style="text-align: center; padding: 50px; color: #f00;">
                        <h1>Error Loading Content</h1>
                        <p>Could not load portfolio data. Please try refreshing the page or contact support.</p>
                    </div>
                `;
            }
        }

        // Function to dynamically build the navigation menu
        function buildNavigation() {
            const navList = document.getElementById('main-nav-list');
            navList.innerHTML = ''; // Clear existing static items (except About/Contact which are handled separately)

            // Add static About link first
            const aboutLink = document.createElement('a');
            aboutLink.href = "#";
            aboutLink.className = "nav-item";
            aboutLink.dataset.section = "about";
            aboutLink.textContent = "About";
            navList.appendChild(aboutLink);

            // Dynamically add category links
            for (const categoryId in siteCategories) {
                const category = siteCategories[categoryId];
                const link = document.createElement('a');
                link.href = "#";
                link.className = "nav-item";
                link.dataset.section = categoryId;
                link.textContent = category.title;
                navList.appendChild(link);
            }

            // Add static Contact link last
            const contactLink = document.createElement('a');
            contactLink.href = "#";
            contactLink.className = "nav-item";
            contactLink.dataset.section = "contact";
            contactLink.textContent = "Contact";
            navList.appendChild(contactLink);

            // Re-select navItems after they are built
            navItems = document.querySelectorAll('.nav-item[data-section]');
            attachNavEventListeners(); // Attach event listeners to newly created nav items
        }

        // Function to attach event listeners to nav items
        function attachNavEventListeners() {
            navItems.forEach(item => {
                item.removeEventListener('click', handleNavItemClick); // Remove old listeners if any
                item.addEventListener('click', handleNavItemClick);
            });
        }

        function handleNavItemClickOld(e) {
            e.preventDefault();
            
            navItems.forEach(nav => nav.classList.remove('active'));
            this.classList.add('active'); // 'this' refers to the clicked element
            
            contentSections.forEach(section => section.classList.remove('active'));
            const targetSection = document.getElementById(this.dataset.section);
            if (targetSection) {
                previousSection = currentSection;
                currentSection = this.dataset.section;
                targetSection.classList.add('active');
            }
        }
        function handleNavItemClick(e) {
            e.preventDefault();
            
            // Remove 'active' from all nav items
            navItems.forEach(nav => nav.classList.remove('active'));
            this.classList.add('active'); // 'this' refers to the clicked nav
            
            // Get all current content sections, including any dynamically injected ones
            const allSections = document.querySelectorAll('.content-section');
            allSections.forEach(section => section.classList.remove('active'));
            
            // Activate the target section
            const targetSection = document.getElementById(this.dataset.section);
            if (targetSection) {
                targetSection.classList.add('active');
            }
        }

        // Function to dynamically populate the main content sections
        function populateSections() {
            const dynamicContentContainer = document.getElementById('dynamic-content-sections');
            dynamicContentContainer.innerHTML = ''; // Clear existing dynamic sections

            for (const categoryId in siteCategories) {
                const category = siteCategories[categoryId];
                
                // Create section element
                const section = document.createElement('section');
                section.id = categoryId;
                section.className = 'content-section';

                // Create header
                const header = document.createElement('div');
                header.className = 'section-header';
                header.innerHTML = `
                    <h1 class="section-title">${category.title}</h1>
                    <p class="section-subtitle">${category.subtitle}</p>
                `;
                section.appendChild(header);

                // Create content grid or list based on listType
                let contentContainer;
                if (category.listType === 'card-grid') {
                    contentContainer = document.createElement('div');
                    contentContainer.className = 'cards-grid';
                    category.items.forEach(itemId => {
                        const item = siteContentItems[itemId];
                        if (item) {
                            const card = document.createElement('div');
                            card.className = 'content-card';
                            card.setAttribute('onclick', `showContent('${itemId}')`);
                            card.innerHTML = `
                                <div class="card-header">
                                    <h3 class="card-title">${item.title}</h3>
                                    <span class="card-status status-${item.status.toLowerCase().replace(/\s/g, '-') || 'concept'}">${item.status}</span>
                                </div>
                                <p class="card-description">${item.subtitle}</p>
                            `;
                            contentContainer.appendChild(card);
                        }
                    });
                } else if (category.listType === 'writing-list') {
                    contentContainer = document.createElement('ul');
                    contentContainer.className = 'writings-list';
                    category.items.forEach(itemId => {
                        const item = siteContentItems[itemId];
                        if (item) {
                            const listItem = document.createElement('li');
                            listItem.className = 'writing-item';
                            listItem.setAttribute('onclick', `showContent('${itemId}')`);
                            listItem.innerHTML = `<a href="#">${item.title}</a>`;
                            contentContainer.appendChild(listItem);
                        }
                    });
                }
                section.appendChild(contentContainer);
                dynamicContentContainer.appendChild(section);
            }
        }

        // Event listener for DOMContentLoaded to fetch data and initialize
        document.addEventListener('DOMContentLoaded', fetchSiteData);

        

        // Show content page
        function showContent(contentId) {
            const data = siteContentItems[contentId]; // Use siteContentItems
            if (!data) {
                console.error("Content ID not found:", contentId);
                return;
            }

            // Update nav to content page (no nav item for content page)
            navItems.forEach(nav => nav.classList.remove('active'));
            
            // Hide all sections and show content page
            document.querySelectorAll('.content-section').forEach(section => section.classList.remove('active'));
            document.getElementById('content-page').classList.add('active');
            
            // Update content page with data
            document.getElementById('content-meta-title').textContent = data.title;
            document.getElementById('content-title').textContent = data.title;
            document.getElementById('content-subtitle').textContent = data.subtitle;
            document.getElementById('content-status').textContent = data.status;
            document.getElementById('content-timeline').textContent = data.timeline;
            
            // Update tags
            const tagsContainer = document.getElementById('content-tags');
            tagsContainer.innerHTML = data.tags.map(tag => `<span class="tag">${tag}</span>`).join('');
            
            // Update references
            const refsContainer = document.getElementById('content-refs');
            refsContainer.innerHTML = data.refs.map(ref => `<li><a href="${ref.link}">${ref.text}</a></li>`).join('');
            
            // Update external links
            const externalContainer = document.getElementById('content-external');
            externalContainer.innerHTML = data.external.map(ext => `<li><a href="${ext.link}">${ext.text}</a></li>`).join('');
            
            // Update content body
            document.getElementById('content-body').innerHTML = data.content;
            
            


            // Store previous section for back navigation
            previousSection = currentSection;
            currentSection = 'content-page';
        }

        // Go back to previous section
        function goBack() {
            // Hide content page
            document.getElementById('content-page').classList.remove('active');
            
            // Show previous section
            const prevSection = document.getElementById(previousSection);
            if (prevSection) {
                prevSection.classList.add('active');
                
                // Update nav active state
                const navItem = document.querySelector(`[data-section="${previousSection}"]`);
                if (navItem) {
                    navItems.forEach(nav => nav.classList.remove('active'));
                    navItem.classList.add('active');
                }
                
                currentSection = previousSection;
            }
        }

        // Mobile navigation toggle
        function toggleNav() {
            const navPanel = document.getElementById('navPanel');
            navPanel.classList.toggle('open');
        }

        // Close mobile nav when clicking outside
        document.addEventListener('click', (e) => {
            const navPanel = document.getElementById('navPanel');
            const menuBtn = document.querySelector('.mobile-menu-btn');
            
            if (window.innerWidth <= 768 && 
                !navPanel.contains(e.target) && 
                !menuBtn.contains(e.target)) {
                navPanel.classList.remove('open');
            }
        });

        // Close mobile nav when window is resized to desktop
        window.addEventListener('resize', () => {
            if (window.innerWidth > 768) {
                document.getElementById('navPanel').classList.remove('open');
            }
        });

        
    </script>
</body>
</html>

